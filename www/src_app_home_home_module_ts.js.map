{"version":3,"file":"src_app_home_home_module_ts.js","mappings":"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","sources":["./node_modules/@capacitor/camera/dist/esm/definitions.js","./node_modules/@capacitor/camera/dist/esm/index.js","./src/app/home/home-routing.module.ts","./src/app/home/home.module.ts","./src/app/home/home.page.ts","./src/app/services/avatar.service.ts","./src/app/home/home.page.html"],"sourcesContent":["export var CameraSource;\n(function (CameraSource) {\n    /**\n     * Prompts the user to select either the photo album or take a photo.\n     */\n    CameraSource[\"Prompt\"] = \"PROMPT\";\n    /**\n     * Take a new photo using the camera.\n     */\n    CameraSource[\"Camera\"] = \"CAMERA\";\n    /**\n     * Pick an existing photo fron the gallery or photo album.\n     */\n    CameraSource[\"Photos\"] = \"PHOTOS\";\n})(CameraSource || (CameraSource = {}));\nexport var CameraDirection;\n(function (CameraDirection) {\n    CameraDirection[\"Rear\"] = \"REAR\";\n    CameraDirection[\"Front\"] = \"FRONT\";\n})(CameraDirection || (CameraDirection = {}));\nexport var CameraResultType;\n(function (CameraResultType) {\n    CameraResultType[\"Uri\"] = \"uri\";\n    CameraResultType[\"Base64\"] = \"base64\";\n    CameraResultType[\"DataUrl\"] = \"dataUrl\";\n})(CameraResultType || (CameraResultType = {}));\n","import { registerPlugin } from '@capacitor/core';\nconst Camera = registerPlugin('Camera', {\n    web: () => import('./web').then(m => new m.CameraWeb()),\n});\nexport * from './definitions';\nexport { Camera };\n","import { NgModule } from '@angular/core';\nimport { RouterModule, Routes } from '@angular/router';\nimport { HomePage } from './home.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: HomePage,\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule]\n})\nexport class HomePageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { IonicModule } from '@ionic/angular';\nimport { FormsModule } from '@angular/forms';\nimport { HomePage } from './home.page';\n\nimport { HomePageRoutingModule } from './home-routing.module';\n\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    HomePageRoutingModule\n  ],\n  declarations: [HomePage]\n})\nexport class HomePageModule {}\n","import { Component } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { Camera, CameraResultType, CameraSource } from '@capacitor/camera';\nimport { AlertController, LoadingController } from '@ionic/angular';\nimport { AuthService } from '../services/auth.service';\nimport { AvatarService } from '../services/avatar.service';\n\nimport { Geolocation } from '@awesome-cordova-plugins/geolocation/ngx';\n\n@Component({\n  selector: 'app-home',\n  templateUrl: 'home.page.html',\n  styleUrls: ['home.page.scss'],\n})\nexport class HomePage {\n  profile = null;\n  latitud: number;\n  longitud: number;\n\n  constructor(\n    private avatarService: AvatarService,\n    private authService: AuthService,\n    private router: Router,\n    private loadingController: LoadingController,\n    private alertController: AlertController\n  ) {\n    this.avatarService.getUserProfile().subscribe((data) => {\n      this.profile = data;\n    });\n  }\n\n  async logout() {\n    await this.authService.logout();\n    this.router.navigateByUrl('/', { replaceUrl: true });\n  }\n\n  async changeImage() {\n    const image = await Camera.getPhoto({\n      quality: 90,\n      allowEditing: false,\n      resultType: CameraResultType.Base64,\n      source: CameraSource.Camera, // Camera, Photos or Prompt!\n    });\n\n    if (image) {\n      const loading = await this.loadingController.create();\n      await loading.present();\n\n      const result = await this.avatarService.uploadImage(image);\n      loading.dismiss();\n\n      if (!result) {\n        const alert = await this.alertController.create({\n          header: 'Upload failed',\n          message: 'There was a problem uploading your avatar.',\n          buttons: ['OK'],\n        });\n        await alert.present();\n      }\n    }\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Auth } from '@angular/fire/auth';\nimport { doc, docData, Firestore, setDoc } from '@angular/fire/firestore';\nimport {\n  getDownloadURL,\n  ref,\n  Storage,\n  uploadString,\n} from '@angular/fire/storage';\nimport { Photo } from '@capacitor/camera';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class AvatarService {\n  constructor(\n    private auth: Auth,\n    private firestore: Firestore,\n    private storage: Storage\n  ) {}\n\n  getUserProfile() {\n    const user = this.auth.currentUser;\n    const userDocRef = doc(this.firestore, `users/${user.uid}`);\n    return docData(userDocRef);\n  }\n\n  async uploadImage(cameraFile: Photo) {\n    const user = this.auth.currentUser;\n    const path = `uploads/${user.uid}/profile.png`;\n    const storageRef = ref(this.storage, path);\n\n    try {\n      await uploadString(storageRef, cameraFile.base64String, 'base64');\n\n      const imageUrl = await getDownloadURL(storageRef);\n\n      const userDocRef = doc(this.firestore, `users/${user.uid}`);\n      await setDoc(userDocRef, {\n        imageUrl,\n      });\n      return true;\n    } catch (e) {\n      return null;\n    }\n  }\n}\n","export default \"<ion-header>\\n  <ion-toolbar color=\\\"primary\\\">\\n    <ion-buttons slot=\\\"start\\\">\\n      <ion-button (click)=\\\"logout()\\\">\\n        <ion-icon slot=\\\"icon-only\\\" name=\\\"log-out\\\"></ion-icon>\\n      </ion-button>\\n    </ion-buttons>\\n    <ion-title> INNEC </ion-title>\\n  </ion-toolbar>\\n</ion-header>\\n\\n<ion-content class=\\\"ion-padding\\\">\\n  <div class=\\\"preview\\\">\\n    <ion-avatar>\\n      <img *ngIf=\\\"profile?.imageUrl; else placeholder_avatar;\\\" [src]=\\\"profile.imageUrl\\\" />\\n    </ion-avatar>\\n  </div>\\n\\n  <ion-fab vertical=\\\"bottom\\\" horizontal=\\\"end\\\" slot=\\\"fixed\\\">\\n    <ion-fab-button (click)=\\\"changeImage()\\\">\\n      <ion-icon name=\\\"camera\\\"></ion-icon>\\n    </ion-fab-button>\\n  </ion-fab>\\n  <ion-toolbar>\\n    <ion-title>\\n      Geolocalizacion\\n    </ion-title>\\n  </ion-toolbar>\\n\\n  <!-- <div class=\\\"ion-padding\\\" style=\\\"text-align: center\\\"> \\n    <ion-label>COORDENADAS</ion-label>\\n  </div>-->\\n\\n  <!-- <div class=\\\"ion-padding\\\">\\n    <ion-item>\\n      <ion-label>LATITUD: {{latitud}}</ion-label>\\n    </ion-item>\\n  </div>\\n\\n  <div class=\\\"ion-padding\\\">\\n    <ion-label>LONGITUD: {{longitud}}</ion-label>\\n    </ion-item>\\n  </div>\\n\\n  <div class=\\\"ion-padding\\\">\\n    <ion-button expand=\\\"full\\\" (click)=obtenerCoordenadas()>Capturar Coordenas</ion-label>\\n    </ion-item>\\n  </div>-->\\n</ion-content>\";"],"names":[],"sourceRoot":"webpack:///"}